<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- SQL Mapping -->
<mapper namespace="com.ai.mypage.dao.MyAnalyzeInfoMapper">
	<!-- 분석정보 조회 -->
	<select id="selectAnalyzeInfoOne" parameterType="com.ai.mypage.vo.MyAnalyzeInfoVo" resultType="com.ai.mypage.vo.MyAnalyzeInfoVo">
		SELECT USER_ID
			 , ANALYZE_INFO_ID
			 , CA.FST_CRER_ID
			 , IFNULL((SELECT USER_NM FROM CU_USER WHERE USER_ID = CA.FST_CRER_ID), CA.FST_CRER_ID) AS FST_CRER_NM
			 , DATE_FORMAT(FST_CRE_DTM, '%Y-%m-%d %h:%i') AS FST_CRE_DTM
			 , CA.AUDIT_ID
			 , IFNULL((SELECT USER_NM FROM CU_USER WHERE USER_ID = CA.AUDIT_ID), CA.AUDIT_ID) AS AUDIT_NM
			 , DATE_FORMAT(AUDIT_DTM, '%Y-%m-%d %h:%i') AS AUDIT_DTM
			 , BADUK_TENDENCY
			 , VICTORY_PATTERN
			 , BP
			 , IBM
			 , TARGET
			 , OPENING
			 , OPENING_STARTING
			 , OPENING_AI_MATCH_RATE
			 , OPENING_AI_GRAPH
			 , OPENING_MISS_RATE
			 , MIDDLE_GAME
			 , MIDDLE_GAME_COMBATIVE_POWER
			 , MIDDLE_GAME_SAVE_RATE
			 , MIDDLE_GAME_MISS_CNT
			 , MIDDLE_GAME_MISS_RATE
			 , END_GAME
			 , END_GAME_DEFENSE
			 , END_GAME_DEFENSE_FAILURE
			 , END_GAME_TURN_THE_TABLES
			 , END_GAME_MISS_CNT
			 , GAME_TIMING
			 , GAME_TIMING_WAVE
			 , GAME_TIMING_DEFENCE
			 , TECHNIQUE
			 , TECHNIQUE_VALUE_JUDGMENT
			 , TECHNIQUE_HAENGMA
			 , TECHNIQUE_READING
			 , EXAM_OPENING_POSITIONAL_JUDGMENT
			 , EXAM_HAENGMA_VALUE_JUDGMENT
			 , EXAM_READING_LIFE_AND_DEATH
			 , EXAM_END_GAME_COUNTING
			 , ETC
		  FROM CU_ANALYZE_INFO CA
	     WHERE USER_ID = #{userId}
	       AND ANALYZE_INFO_ID = (SELECT MAX(ANALYZE_INFO_ID) FROM CU_ANALYZE_INFO WHERE USER_ID = #{userId})
	</select>

</mapper>